<div class="mainContent-innner">
  <div class="Stock-section">
    <div class="d-flex align-items-center">
      <h4 class="title flex-grow-1 mb-0">{{ salesByText }}</h4>
      <!-- <div class="probtn-wrap d-flex text-right">            
                <button type="button" data-toggle="modal" data-target="#reportFilter" class="btn btn-blue with-icon">
                    <i class="icon fa fa-file"></i> {{salesByText}}
                </button>
            </div>           -->
    </div>
    <div class="bg-box mt-15 vh-100">
      <!-- <iframe [src]='safeURL' frameborder="0" allowfullscreen width="100%" height="100%"></iframe> -->
      <ngx-extended-pdf-viewer [src]="pdfData" [height]="'90vh'" [useBrowserLocale]="true" [textLayer]="true"
        [showHandToolButton]="true" [zoom]="'page-width'">
      </ngx-extended-pdf-viewer>
    </div>
  </div>
</div>

<div class="modal fade bd-example-modal-xl thm-popup" id="reportFilter" tabindex="-1" role="dialog"
  aria-labelledby="reportFilterModalLabel" aria-hidden="true">
  <form [formGroup]="summeryReportForm">
    <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
      <div class="modal-content">
        <div class="modal-body popup-box-width">
          <div class="popup-box">
            <div class="form-row align-items-center">
              <!-- Added click event to close promotion dropdown forcefully -->
              <div class="col-5">
                <div class="title-wra mb-0">
                  <h4 class="title">{{ salesByText }}</h4>
                </div>
              </div>

              <!-- Added click event to close promotion dropdown forcefully -->
              <div class="col-7">
                <div class="text-right">
                  <div class="custom-control form-group custom-checkbox mb-0">
                    <input type="checkbox" class="custom-control-input keep_Filter" id="{{ reporterObj.currentUrl }}"
                      (change)="
                        onDateOrKeepFilterChange(
                          'keepFilter',
                          $event.target.checked
                        )
                      " [checked]="
                        dropdownObj?.keep_filter
                          ? dropdownObj?.keep_filter[reporterObj.currentUrl]
                          : false
                      " />

                    <label class="custom-control-label mb-0" for="{{ reporterObj.currentUrl }}">Keep current
                      filter</label>
                    <button type="button" class="btn ml-2 btn-grey btn-grey-refresh" (click)="refreshBtnClicked()">
                      <i class="icon fa fa-refresh"></i>
                    </button>
                  </div>
                </div>
              </div>
              <div class="col-lg-5 col-xl-5">
                <div class="group-from mb-0 report-form-group group-height">
                  <h5 class="title">Date Range</h5>
                  <div class="accordion exclude-list mb-3" id="accordionExample">
                    <div id="headingOne">
                      <a href="javascript:void(0);" class="Out-btn" data-toggle="collapse" data-target="#collapseOne"
                        aria-expanded="true" aria-controls="collapseOne"></a>
                    </div>
                    <div id="collapseOne" class="collapse show" aria-labelledby="headingOne"
                      data-parent="#accordionExample">
                      <!-- DATE RANGE -->
                      <div class="submenu h-auto">
                        <div class="form-row align-items-center">
                          <div class="col-4">
                            <div class="form-group mb-0">
                              <div class="ctm-calendar">
                                <input type="text" onkeydown="return false" class="form-control"
                                  (bsValueChange)="onDateChange($event, 'startDate', true); specDateChange($event, f?.endDate?.value);"
                                  bsDatepicker [bsValue]="startDateBsValue" [bsConfig]="datepickerConfig"
                                  [maxDate]="maxDate" [ngClass]="{
                                    'is-invalid': submitted && f.startDate.errors
                                  }" />
                              </div>
                            </div>
                          </div>
                          <div class="col-2">
                            <div class="form-group mb-0 text-center">
                              <label for="" class="mb-0">To</label>
                            </div>
                          </div>
                          <div class="col-4">
                            <div class="form-group mb-0">
                              <div class="ctm-calendar">
                                <input type="text" onkeydown="return false" class="form-control" bsDatepicker
                                  [bsValue]="endDateBsValue" [minDate]="lastEndDate || f?.startDate?.value"
                                  [bsConfig]="datepickerConfig"
                                  (bsValueChange)="onDateChange($event, 'endDate'); specDateChange(f?.startDate?.value, $event);"
                                  [maxDate]="maxDate" [ngClass]="{
                                    'is-invalid': submitted && f.endDate.errors
                                  }" />
                                <div *ngIf="f.endDate.errors" class="invalid-feedback">
                                  <div *ngIf="f.endDate.errors.required">
                                    End date is required
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <!-- <div class="col-2">
                           <button type="button" class="btn btn-blue btn-block input-btn btn-grey">...</button>
                          </div> -->
                        </div>
                        <!-- <div class="form-row form-group mb-0 mt-2">
                          <ng-container *ngFor="let day of dropdownObj.days">
                            <div class="col-lg-4">
                              <div class="custom-control custom-checkbox">
                                <input type="checkbox" class="custom-control-input" [id]="day.code" (change)="
                                    onDateOrKeepFilterChange(
                                      'day',
                                      $event.target.checked,
                                      day.code ,
                                      day.name
                                    )
                                  " [checked]="
                                    f?.days?.value?.includes(day.code)
                                      ? true
                                      : false
                                  " />
                                <label class="custom-control-label mb-0" [for]="day.code">
                                  {{ day.name }}
                                </label>
                              </div>
                            </div>
                          </ng-container>
                        </div> -->
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-lg-4 col-xl-4">

                <div class="group-from mb-0 report-form-group group-height">
                  <h5 class="title">Codes</h5>

                  <div class="form-group form-row">
                    <label class="label col-md-3 mb-0">Stores</label>
                    <div class="col-md-9 mb-0">
                      <ng-select [clearSearchOnAdd]="true" [items]="dropdownObj.stores" bindLabel="storeDetail"
                      bindValue="id" [clearSearchOnAdd]="true" [closeOnSelect]="false" [virtualScroll]="false"
                      [multiple]="true" placeholder="Select Store" formControlName="storeIds" (search)="
                        searchBtnAction(
                          $event,
                          reporterObj.dropdownField.stores
                        )
                      " (change)="
                        setDropdownSelection(
                          reporterObj.dropdownField.stores,
                          $event
                        )
                      " (open)="
                        getAndSetFilterData(
                          reporterObj.dropdownField.stores,
                          reporterObj.dropdownField.storeIds,
                          true
                        )
                      " (remove)="
                        addOrRemoveItem(
                          $event,
                          reporterObj.dropdownField.stores,
                          'remove'
                        )
                      " (clear)="
                        addOrRemoveItem(
                          $event,
                          reporterObj.dropdownField.stores,
                          'clear_all',
                          reporterObj.dropdownField.storeIds
                        )
                      " (add)="
                        addOrRemoveItem(
                          $event,
                          reporterObj.dropdownField.stores,
                          'add'
                        )
                      " [ngClass]="{
                        'is-invalid': submitted && f.storeIds.errors
                      }">
                      <!-- It hold value on the basis of filter -->
                      <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
                        <div class="form-row">
                          <div class="col-9 zone-overflow">
                            <input id="item-{{ index }}" type="checkbox" [checked]="
                            reporterObj?.remove_index_map?.stores[item.id]
                              ? true
                              : false
                          " />&nbsp;
                            <span title="{{ item?.desc }}">
                              {{ item?.desc }}
                            </span>
                          </div>
                          <div class="col-3">
                            {{ item?.code }}
                          </div>
                        </div>
                        <!-- <input id="item-{{ index }}" type="checkbox" [checked]="
                            reporterObj?.remove_index_map?.stores[item.id]
                              ? true
                              : false
                          " />&nbsp;
                        <span>{{ item.desc }}&nbsp;&nbsp;({{ item.code }})</span> -->
                        <span>{{
                          selectAll(reporterObj.dropdownField.stores, item)
                          }}</span>
                      </ng-template>

                      <!-- Add button on top of the select and perform operations -->
                      <ng-template ng-header-tmp>
                        <div class="form-row align-items-center form-group mb-0">
                         
                          <div class="col-12 text-right">
                            <button (click)="
                                addOrRemoveItem(
                                  null,
                                  reporterObj.dropdownField.stores,
                                  reporterObj?.button_text?.stores,
                                  reporterObj.dropdownField.storeIds
                                )
                              " class="btn btn-blue input-btn btn-grey">
                              {{ reporterObj?.button_text?.stores }}
                            </button>
                          </div>
                        </div>
                      </ng-template>

                      <!-- Add more tag with count -->
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:2">
                          <span class="ng-value-label">{{ item.desc }}</span>
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 2">
                          <span class="ng-value-label">{{ items.length - 2 }} more...</span>
                        </div>
                      </ng-template>
                    </ng-select>
                    <div *ngIf="f.storeIds.errors" class="invalid-feedback">
                      <div *ngIf="f.storeIds.errors.required">
                        Store is required
                      </div>
                    </div>
                    </div>
                  </div>  

                  <div class="form-group form-row">
                    <label class="label col-md-3 mb-0">Zones</label>
                    <div class="col-md-9 mb-0">
                      <ng-select [clearSearchOnAdd]="true" [items]="dropdownObj.zones" bindLabel="name" bindValue="id"
                      [closeOnSelect]="false" [virtualScroll]="false" [multiple]="true" placeholder="Select Zone"
                      formControlName="zoneIds" (search)="
                        searchBtnAction($event, reporterObj.dropdownField.zones)
                      " (change)="
                        setDropdownSelection(
                          reporterObj.dropdownField.zones,
                          $event
                        )
                      " (open)="
                        getAndSetFilterData(
                          reporterObj.dropdownField.zones,
                          reporterObj.dropdownField.zoneIds,
                          true
                        )
                      " (remove)="
                        addOrRemoveItem(
                          $event,
                          reporterObj.dropdownField.zones,
                          'remove'
                        )
                      " (clear)="
                        addOrRemoveItem(
                          $event,
                          reporterObj.dropdownField.zones,
                          'clear_all',
                          reporterObj.dropdownField.zoneIds
                        )
                      " (add)="
                        addOrRemoveItem(
                          $event,
                          reporterObj.dropdownField.zones,
                          'add'
                        )
                      ">
                      <!-- It hold value on the basis of filter -->
                      <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
                        <div class="form-row">
                          <div class="col-9 zone-overflow">
                            <input id="item-{{ index }}" type="checkbox" [checked]="
                            reporterObj?.remove_index_map?.zones[item.id]
                              ? true
                              : false
                          " />&nbsp;
                            <span title="{{ item?.name }}">
                              {{ item?.name }}
                            </span>
                          </div>
                          <div class="col-3">
                            {{ item?.code }}
                          </div>
                        </div>
                        <span>{{
                          selectAll(reporterObj.dropdownField.zones, item)
                          }}</span>
                      </ng-template>

                      <!-- Add button on top of the select and perform operations -->
                      <ng-template ng-header-tmp>
                        <div class="form-row align-items-center form-group mb-0">
                          <!-- <div class="col-8"></div> -->
                          <div class="col-6">
                            <div class="custom-control custom-checkbox">
                              <input type="checkbox" class="custom-control-input" id="deptFilter1"
                                (change)="filterStore($event.target.checked)"
                                [checked]="reporterObj?.autoSelectStores ? true :false" />
                              <label class="custom-control-label mb-0" for="deptFilter1">
                                Auto select linked stores
                              </label>
                            </div>
                          </div>
                          <div class="col-6 text-right">
                            <button (click)="
                                addOrRemoveItem(
                                  null,
                                  reporterObj.dropdownField.zones,
                                  reporterObj?.button_text?.zones,
                                  reporterObj.dropdownField.zoneIds
                                )
                              " class="btn btn-blue input-btn btn-grey">
                              {{ reporterObj?.button_text?.zones }}
                            </button>
                          </div>
                        </div>
                      </ng-template>

                      <!-- Add more tag with count -->
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:2">
                          <span class="ng-value-label">{{ item.name }}</span>
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 2">
                          <span class="ng-value-label">{{ items.length - 2 }} more...</span>
                        </div>
                      </ng-template>
                    </ng-select>
                    </div>
                  </div>  

                  <!-- WARNING :: Not able to see this dropdown in old application, implemented by ST  -->
                  <div class="form-group form-row" *ngIf="
                  reporterObj.currentUrl !==
                    reportNameObj.finance ">
                    <label class="label col-md-3 mb-0">Departments</label>
                    <div class="col-md-9 mb-0">
                      <ng-select [clearSearchOnAdd]="true" [items]="dropdownObj.departments" bindLabel="desc"
                      bindValue="id" [closeOnSelect]="false" [virtualScroll]="false" [multiple]="true"
                      dropdownPosition="bottom" placeholder="Select Department" formControlName="departmentIds"
                      (search)="
                        searchBtnAction(
                          $event,
                          reporterObj.dropdownField.departments
                        )
                      " (change)="
                        setDropdownSelection(
                          reporterObj.dropdownField.departments,
                          $event
                        )
                      " (open)="
                        getAndSetFilterData(
                          reporterObj.dropdownField.departments,
                          reporterObj.dropdownField.departmentIds,
                          true
                        )
                      " (remove)="
                        addOrRemoveItem(
                          $event,
                          reporterObj.dropdownField.departments,
                          'remove'
                        )
                      " (clear)="
                        addOrRemoveItem(
                          $event,
                          reporterObj.dropdownField.departments,
                          'clear_all',
                          reporterObj.dropdownField.departmentIds
                        )
                      " (add)="
                        addOrRemoveItem(
                          $event,
                          reporterObj.dropdownField.departments,
                          'add'
                        )
                      " [ngClass]="{
                        'is-invalid': submitted && f.departmentIds.errors
                      }">
                      <!-- It hold value on the basis of filter -->
                      <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
                        <div class="form-row">
                          <div class="col-9 zone-overflow">
                            <input id="item-{{ index }}" type="checkbox" [checked]="
                            reporterObj?.remove_index_map?.departments[item.id]
                              ? true
                              : false
                          " />&nbsp;
                            <span title="{{ item?.desc }}">
                              {{ item?.desc }}
                            </span>
                          </div>
                          <div class="col-3">
                            {{ item?.code }}
                          </div>
                        </div>
                        <span>{{
                          selectAll(reporterObj.dropdownField.departments, item)
                          }}</span>
                      </ng-template>

                      <!-- Add button on top of the select and perform operations -->
                      <ng-template ng-header-tmp>
                        <div class="form-row align-items-center form-group mb-0">
                          <!-- <div class="col-8"> -->
                            <!-- <div class="custom-control custom-checkbox">
                              <input type="checkbox" class="custom-control-input" id="deptFilter"
                                (change)="filterData($event.target.checked)" />
                              <label class="custom-control-label mb-0" for="deptFilter">
                                Auto select linked Commodities
                              </label>
                            </div> -->
                          <!-- </div> -->
                          <div class="col-12 text-right">
                            <button (click)="
                                addOrRemoveItem(
                                  null,
                                  reporterObj.dropdownField.departments,
                                  reporterObj?.button_text?.departments,
                                  reporterObj.dropdownField.departmentIds
                                )
                              " class="btn btn-blue input-btn btn-grey">
                              {{ reporterObj?.button_text?.departments }}
                            </button>
                          </div>
                        </div>
                      </ng-template>

                      <!-- Add more tag with count -->
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:2">
                          <span class="ng-value-label">{{ item.desc }}</span>
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 2">
                          <span class="ng-value-label">{{ items.length - 2 }} more...</span>
                        </div>
                      </ng-template>
                    </ng-select>
                    <!-- <div *ngIf="f.departmentIds.errors" class="invalid-feedback">
                      <div *ngIf="f.departmentIds.errors.required">
                        Department is Required
                      </div>
                    </div> -->
                    </div>
                  </div>

                  <div class="form-group form-row">
                    <label class="label col-md-3 mb-0">Stores</label>
                    <div class="col-md-9 mb-0">
                      <ng-select [clearSearchOnAdd]="true" [items]="dropdownObj.cashiers" bindLabel="firstName"
                      bindValue="id" [closeOnSelect]="false" [virtualScroll]="false" [multiple]="true"
                      placeholder="Select Cashier" formControlName="cashierIds" (search)="
                        searchBtnAction($event, reporterObj.dropdownField.cashiers)
                      " (change)="
                        setDropdownSelection(
                          reporterObj.dropdownField.cashiers,
                          $event
                        )
                      " (open)="
                        getAndSetFilterData(
                          reporterObj.dropdownField.cashiers,
                          reporterObj.dropdownField.cashierIds,
                          true
                        )
                      " (remove)="
                        addOrRemoveItem(
                          $event,
                          reporterObj.dropdownField.cashiers,
                          'remove'
                        )
                      " (clear)="
                        addOrRemoveItem(
                          $event,
                          reporterObj.dropdownField.cashiers,
                          'clear_all',
                          reporterObj.dropdownField.cashierIds
                        )
                      " (add)="
                        addOrRemoveItem(
                          $event,
                          reporterObj.dropdownField.cashiers,
                          'add'
                        )
                      ">
                      <!-- It hold value on the basis of filter -->
                      <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
                        <div class="form-row">
                          <div class="col-10 zone-overflow">
                            <input id="item-{{ index }}" type="checkbox" [checked]="
                            reporterObj?.remove_index_map?.cashiers[item?.id]
                              ? true
                              : false
                          " />&nbsp;
                            <span title="{{ item?.firstName }} {{ item.surname }}">
                              {{ item.firstName }}&nbsp;{{ item.surname }}
                            </span>
                          </div>
                          <div class="col-2" title="{{ item?.number }}">
                            {{ item?.number }}
                          </div>
                        </div>
                        <span>{{
                          selectAll(reporterObj.dropdownField.cashiers, item)
                          }}</span>
                      </ng-template>

                      <!-- Add button on top of the select and perform operations -->
                      <ng-template ng-header-tmp>
                        <div class="form-row align-items-center form-group mb-0">
                          <div class="col-12 text-right">
                            <button (click)="
                                addOrRemoveItem(
                                  null,
                                  reporterObj.dropdownField.cashiers,
                                  reporterObj?.button_text?.cashiers,
                                  reporterObj.dropdownField.cashierIds
                                )
                              " class="btn btn-blue input-btn btn-grey">
                              {{ reporterObj?.button_text?.cashiers }}
                            </button>
                          </div>
                        </div>
                      </ng-template>

                      <!-- Add more tag with count -->
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:2">
                          <span class="ng-value-label">{{ item.firstName }}</span>
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 2">
                          <span class="ng-value-label">{{ items.length - 2 }} more...</span>
                        </div>
                      </ng-template>
                    </ng-select>
                    </div>
                  </div>
                  
                  <div class="form-group form-row">
                    <label class="label col-md-3 mb-0">Tills</label>
                    <div class="col-md-9 mb-0">
                      <ng-select [clearSearchOnAdd]="true" [items]="dropdownObj.tills" bindLabel="desc" bindValue="id"
                      [closeOnSelect]="false" [virtualScroll]="false" [multiple]="true" placeholder="Select Till"
                      formControlName="tillId" (search)="
                        searchBtnAction($event, reporterObj.dropdownField.tills)
                      " (change)="
                        setDropdownSelection(
                          reporterObj.dropdownField.tills,
                          $event
                        )
                      " (open)="
                        getAndSetFilterData(
                          reporterObj.dropdownField.tills,
                          reporterObj.dropdownField.tillId,
                          true
                        )
                      " (remove)="
                        addOrRemoveItem(
                          $event,
                          reporterObj.dropdownField.tills,
                          'remove'
                        )
                      " (clear)="
                        addOrRemoveItem(
                          $event,
                          reporterObj.dropdownField.tills,
                          'clear_all',
                          reporterObj.dropdownField.tillId
                        )
                      " (add)="
                        addOrRemoveItem(
                          $event,
                          reporterObj.dropdownField.tills,
                          'add'
                        )
                      ">
                      <!-- It hold value on the basis of filter -->
                      <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
                        <div class="form-row">
                          <div class="col-9 zone-overflow">
                            <input id="item-{{ index }}" type="checkbox" [checked]="
                            reporterObj?.remove_index_map?.tills[item.id]
                              ? true
                              : false
                          " />&nbsp;
                            <span title="{{ item?.desc }}">
                              {{ item?.desc }}
                            </span>
                          </div>
                          <div class="col-3">
                            {{ item?.code }}
                          </div>
                        </div>
                        <span>{{
                          selectAll(reporterObj.dropdownField.tills, item)
                          }}</span>
                      </ng-template>

                      <!-- Add button on top of the select and perform operations -->
                      <ng-template ng-header-tmp>
                        <div class="form-row align-items-center form-group mb-0">
                          <div class="col-12 text-right">
                            <button (click)="
                                addOrRemoveItem(
                                  null,
                                  reporterObj.dropdownField.tills,
                                  reporterObj?.button_text?.tills,
                                  reporterObj.dropdownField.tillId
                                )
                              " class="btn btn-blue input-btn btn-grey">
                              {{ reporterObj?.button_text?.tills }}
                            </button>
                          </div>
                        </div>
                      </ng-template>

                      <!-- Add more tag with count -->
                      <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                        <div class="ng-value" *ngFor="let item of items | slice: 0:2">
                          <span class="ng-value-label">{{ item.desc }}</span>
                          <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                        </div>
                        <div class="ng-value" *ngIf="items.length > 2">
                          <span class="ng-value-label">{{ items.length - 2 }} more...</span>
                        </div>
                      </ng-template>
                    </ng-select>
                    </div>
                  </div>
                </div>
              </div>

              <!-- All Selections -->
              <!-- Added click event to close promotion dropdown forcefully -->
              <div class="col-lg-3 col-xl-3">
                <!-- Selections -->
                <div class="group-from mb-0 report-form-group date-range-from group-height">
                  <div class="reportDay_list">
                    <h5 class="title">Selections</h5>
                    <div *ngIf="f?.startDate?.value">
                      <h4>Date Range</h4>
                      <ul>
                        <li>
                          {{ f?.startDate?.value | date: "dd/MM/yyyy" }} to
                          {{ f?.endDate?.value | date: "dd/MM/yyyy" }}
                        </li>
                      </ul>
                    </div>

                    <div class="mt-1" *ngIf="f?.days?.value">
                      <h4>Days</h4>
                      <ul>
                        <li *ngFor="let day of SelectedDayName">
                          {{ day | uppercase }}
                        </li>

                      </ul>
                    </div>
                    <ng-container *ngIf=" reporterObj.currentUrl !== reportNameObj.finance ">
                      <div class="mt-1" *ngIf="selectedValues.departments">
                        <h4>Departments</h4>
                        <ul>
                          <ng-container
                            *ngIf="(dropdownObj.departments?.length !== selectedValues?.departments?.length); else allDeptSelected">
                            <li *ngFor="let deprt of selectedValues.departments">
                              {{ deprt.code }} &nbsp;-&nbsp; {{ deprt.desc }}
                            </li>
                          </ng-container>
                          <ng-template #allDeptSelected>
                            <li>All Values Has Been Selected</li>
                          </ng-template>
                        </ul>
                      </div>
                    </ng-container>

                    <div class="mt-1" *ngIf="selectedValues.stores">
                      <h4>Outlets</h4>
                      <ul>
                        <ng-container
                          *ngIf="(dropdownObj.stores?.length !== selectedValues?.stores?.length); else allStoSelected">
                          <li *ngFor="let store of selectedValues.stores">
                            {{ store.code }} &nbsp;-&nbsp;
                            {{ store.desc }}
                          </li>
                        </ng-container>
                        <ng-template #allStoSelected>
                          <li>All Values Has Been Selected</li>
                        </ng-template>

                      </ul>
                    </div>

                    <div class="mt-1" *ngIf="selectedValues.zones">
                      <h4>Zones</h4>
                      <ul>
                        <ng-container
                          *ngIf="(dropdownObj.zones?.length !== selectedValues?.zones?.length); else allZoneSelected">
                          <li *ngFor="let zone of selectedValues.zones">
                            {{ zone.code }} &nbsp;-&nbsp;&nbsp; {{ zone.name }}
                          </li>
                        </ng-container>
                        <ng-template #allZoneSelected>
                          <li>All Values Has Been Selected</li>
                        </ng-template>
                      </ul>
                    </div>

                    <div class="mt-1" *ngIf="selectedValues?.cashiers">
                      <h4>Cashiers</h4>
                      <ul>
                        <ng-container
                          *ngIf="(dropdownObj.cashiers?.length !== selectedValues?.cashiers?.length); else allCashierSelected">
                          <li *ngFor="let cashier of selectedValues?.cashiers">

                            {{ cashier.number }} &nbsp;-&nbsp; {{ cashier.firstName }}&nbsp;{{ cashier.surname }}
                          </li>
                        </ng-container>
                        <ng-template #allCashierSelected>
                          <li>All Values Has Been Selected</li>
                        </ng-template>
                      </ul>
                    </div>

                    <div class="mt-1" *ngIf="selectedValues.tills">
                      <h4>Tills</h4>
                      <ul>
                        <ng-container
                          *ngIf="(dropdownObj.tills?.length !== selectedValues?.tills?.length); else allZoneSelected">
                          <li *ngFor="let till of selectedValues.tills">
                            {{ till.code }} &nbsp;-&nbsp;{{ till.desc }}
                          </li>
                        </ng-container>
                        <ng-template #allZoneSelected>
                          <li>All Values Has Been Selected</li>
                        </ng-template>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Added click event to close promotion dropdown forcefully -->
              <div class="col-12">
                <div class="btn-wrap text-right mt-10">
                  <button type="button" class="btn btn-grey mr-2" disabled>
                    <i class="fa fa-info-circle"></i> Hide info
                  </button>
                  <button type="button" class="btn btn-grey mr-2" disabled>
                    Mail
                  </button>
                  <button type="button" class="btn btn-grey mr-2" (click)="schedularFilter()">
                    <i class="fa fa-clock-o"></i> Schedule
                  </button>
                  <button type="button" class="btn btn-grey mr-2">
                    <i class="fa fa-save"></i> Save
                  </button>
                  <button type="button" class="btn btn-grey mr-2">
                    <i class="fa fa-folder-open"></i> Load
                  </button>
                  <!-- <a class="btn btn-grey mr-2" (click)="resetForm()">Clear Selections</a> -->
                  <button class="btn btn-blue mr-2" (click)="SumbitReportForm()">
                    Ok
                  </button>
                  <a class="btn btn-grey" data-dismiss="modal" (click)="isCancelApi()" >Cancel</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>
</div>

<div class="modal fade thm-popup" id="schedularFilter" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
  aria-hidden="true" data-backdrop="static">
  <div class="modal-dialog modal-dialog-centered dialog-w2" role="document">
    <div class="modal-content">
      <div class="modal-body popup-box-width border-popup">
        <div class="popup-box">
          <form name="searchForm2" id="searchForm2">
            <div class="title-wrap mb-2">
              <h4 class="title">Filter Name</h4>
            </div>
            <div class="group-from mb-0 mx-2">
              <div class="form-group">
                <input id="financialReportName" type="text" class="form-control col-md-10" placeholder="Report Name"
                  #searchValue />
              </div>

            </div>
            <div class="btn-wrap text-right mt-10">
              <button class="btn btn-blue mr-2" (click)="schedularReport()">Ok</button>
              <button class="btn btn-grey" data-dismiss="modal">Cancel</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="modal fade bd-example-modal-lg thm-popup" id="newSch" tabindex="-1" role="dialog"
  aria-labelledby="reportFilterModalLabel" aria-hidden="true" data-backdrop="static">
  <form [formGroup]="reportScheduleForm">
    <div class="modal-dialog modal-dialog-centered modal-lg border-popup" role="document">
      <div class="modal-content">
        <div class="modal-body popup-box-width">
          <div class="popup-box">
            <div class="form-row align-items-center">
              <!-- Added click event to close promotion dropdown forcefully -->
              <div class="col-12">
                <div class="title-wrap mb-0">
                  <h4 class="title">New Schedule</h4>
                </div>
              </div>
              <!-- Nav tabs -->
              <ul class="nav nav-tabs col-md-12 flag-nav">
                <li class="nav-item">
                  <a class="nav-link active" data-toggle="tab" href="#home">Details</a>
                </li>
                <!-- <li class="nav-item">
                 <a class="nav-link" data-toggle="tab" href="#menu1">Flags</a>
                 </li> -->
              </ul>
              <!-- Tab panes -->
              <div class="tab-content col-md-12 p-0 flag-content">
                <div class="tab-pane active" id="home">
                  <!-- Added click event to close promotion dropdown forcefully -->
                  <div class="col-lg-12 col-xl-12">
                    <!-- General Field Filter -->
                    <div class="form-row align-items-center">
                      <div class="col-md-6">
                        <div class="group-from">
                          <h5 class="title">Reports</h5>
                          <div class="form-row form-group align-items-center">
                            <div class="col-12">
                              <input type="text" class="form-control" formControlName="reportName" readonly />
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-md-6">
                        <div class="group-from">
                          <h5 class="title">Filters</h5>
                          <div class="form-row form-group align-items-center">
                            <div class="col-12">
                              <input type="text" class="form-control" formControlName="description" readonly />
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <!-- Filter Date Range -->
                    <div class="form-row align-items-center">
                      <div class="col-md-6">
                        <div class="group-from">
                          <h5 class="title">
                            Filter Date Range
                          </h5>
                          <div class="form-row form-group align-items-center mb-0">
                            <div class="col-12">
                              <div class="form-row align-items-center">
                                <div class="col-5">
                                  <div class="form-group mb-0">
                                    <div class="ctm-calendar">
                                      <input #startDatesch type="text" class="form-control" bsDatepicker
                                        [bsConfig]="{ showWeekNumbers: false ,adaptivePosition: true}"
                                        [maxDate]="maxDate" [ngClass]="{'is-invalid': submitted && f.startDate.errors}"
                                        (bsValueChange)="onShDateChange($event, 'startDate');scheduleDateChange($event, startDatesch.value);"
                                        [bsValue]="shStartDateBsValue" readonly />
                                      <div *ngIf="f_schedule.startDate?.errors" class="invalid-feedback">
                                        <div *ngIf="f_schedule.startDate?.errors.required">
                                          Start date is required
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-2">
                                  <div class="form-group mb-0 text-center">
                                    <label for class="mb-0">To</label>
                                  </div>
                                </div>
                                <div class="col-5">
                                  <div class="form-group mb-0">
                                    <div class="ctm-calendar">
                                      <input #toDateSch type="text" class="form-control" bsDatepicker
                                        [bsConfig]="{ showWeekNumbers: false }" [maxDate]="maxDate"
                                        [ngClass]="{'is-invalid': isReportScheduleFormSubmitted && f.endDate.errors }"
                                        (bsValueChange)="onShDateChange($event, 'endDate');scheduleDateChange(toDateSch.value,$event);"
                                        [bsValue]="shEndDateBsValue" readonly />
                                      <div *ngIf="f_schedule.endDate?.errors" class="invalid-feedback">
                                        <div *ngIf="f_schedule.endDate?.errors.required">
                                          End date is required
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="col-5">
                              <div *ngIf="false" class="custom-control custom-checkbox">
                                <input formControlName="roleOnCompletion" type="checkbox" class="custom-control-input"
                                  id="Sales" />
                                <label class="custom-control-label mb-0" for="Sales">Roll of open complition</label>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-md-6">
                        <div class="group-from">
                          <h5 class="title">
                            Intervel
                          </h5>
                          <div class="form-row form-group align-items-center mb-0">
                            <div class="col-12">
                              <div class="form-row align-items-center">
                                <div class="col-md-4">
                                  <div class="form-row align-items-center pt-2">
                                    <div class="col-md-4">
                                      <label>Every</label>
                                    </div>
                                    <div class="col-md-8">
                                      <input type="number" name="intervalBracket" [ngClass]="{
                                        'is-invalid':
                                        isReportScheduleFormSubmitted && f_schedule.intervalBracket.errors
                                        }" formControlName="intervalBracket" class="form-control">
                                      <div *ngIf="isReportScheduleFormSubmitted && f_schedule.intervalBracket.errors"
                                        class="invalid-feedback">
                                        <div *ngIf="f_schedule.intervalBracket.errors.required">
                                          required
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-md-8">
                                  <div class="group-from my-0">
                                    <div class="d-flex flex-wrap form-group mb-0">
                                      <div class="custom-control custom-radio mr-2"><input type="radio" name="interval"
                                          class="custom-control-input" formControlName="interval" id="months"
                                          value="1"><label for="months" class="custom-control-label mb-0" for="months">
                                          Months </label>
                                      </div>
                                      <div class="custom-control custom-radio mr-2"><input type="radio" name="interval"
                                          class="custom-control-input" formControlName="interval" id="weeks"
                                          value="2"><label class="custom-control-label mb-0" for="weeks">Weeks </label>
                                      </div>
                                      <div class="custom-control custom-radio mr-2" [ngClass]="{
                                          'is-invalid':
                                          isReportScheduleFormSubmitted && f_schedule.interval.errors
                                          }"><input type="radio" name="interval" class="custom-control-input"
                                          formControlName="interval" id="days" value="3"><label
                                          class="custom-control-label mb-0" for="days"> Days </label>
                                      </div>
                                      <div *ngIf="isReportScheduleFormSubmitted && f_schedule.interval.errors"
                                        class="invalid-feedback">
                                        <div *ngIf="f_schedule.interval.errors.required">
                                          required
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="form-row form-group align-items-center">
                      <div class="col-md-6">
                        <div class="group-from">
                          <h5 class="title">Schedule Group</h5>
                          <div class="form-row form-group align-items-center">
                            <div class="col-10">
                              <select formControlName="groupIds" disabled class="form-control"
                                placeholder='Schedule Group'>
                                <option value="">select</option>
                                <option *ngFor="let item of dropdownObj.stores">
                                  {{ item.storeDetail }}
                                </option>
                              </select>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-6">
                        <div class="group-from">
                          <h5 class="title">Destination email </h5>
                          <div class="form-row form-group align-items-center">
                            <div class="col-12">
                              <ng-select [clearSearchOnAdd]="true" [items]="dropdownObj.users" bindLabel="email"
                                bindValue="id" [clearSearchOnAdd]="true" [closeOnSelect]="false" [virtualScroll]="false"
                                [multiple]="true" placeholder="Destination email" formControlName="userIds" (search)="
                                searchBtnAction(
                                  $event,
                                  reporterObj.dropdownField.users
                                )
                              " (change)="
                                setDropdownSelection(
                                  reporterObj.dropdownField.users,
                                  $event
                                )
                              " (open)="
                                getAndSetFilterData(
                                  reporterObj.dropdownField.users,
                                  reporterObj.dropdownField.userIds,
                                  true
                                )
                              " (remove)="
                                addOrRemoveItem(
                                  $event,
                                  reporterObj.dropdownField.users,
                                  'remove'
                                )
                              " (clear)="
                                addOrRemoveItem(
                                  $event,
                                  reporterObj.dropdownField.users,
                                  'clear_all',
                                  reporterObj.dropdownField.userIds
                                )
                              " (add)="
                                addOrRemoveItem(
                                  $event,
                                  reporterObj.dropdownField.users,
                                  'add'
                                )
                              ">
                                <!-- It hold value on the basis of filter -->
                                <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
                                  <div class="form-row">
                                    <div class="col-12 zone-overflow">
                                      <input id="item-{{ index }}" type="checkbox" [checked]="
                                    reporterObj?.remove_userindex?.users[item.id]
                                      ? true
                                      : false
                                  " />&nbsp;
                                      <span title="{{ item?.firstName }}, {{ item?.lastName }}, {{ item?.email }}">
                                        {{ item.firstName }}, {{ item.lastName }}, {{ item.email }}
                                      </span>
                                    </div>
                                  </div>
                                </ng-template>

                                <!-- Add more tag with count -->
                                <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                                  <div class="ng-value" *ngFor="let item of items | slice: 0:2">
                                    <span class="ng-value-label">{{ item.email }}</span>
                                    <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">×</span>
                                  </div>
                                  <div class="ng-value" *ngIf="items.length > 2">
                                    <span class="ng-value-label">{{ items.length - 2 }} more...</span>
                                  </div>
                                </ng-template>
                              </ng-select>
                              <div *ngIf="isReportScheduleFormSubmitted && f_schedule.userIds.errors"
                                class="invalid-feedback">
                                <div *ngIf="f_schedule.userIds.errors.required">
                                  Destination email is required
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="form-row form-group align-items-center">
                      <div class="col-md-6">
                        <div class="group-from">
                          <h5 class="title">Export Format</h5>
                          <div class="form-row form-group align-items-center">
                            <div class="col-4">
                              <div class="custom-control custom-checkbox">
                                <input formControlName="excelExport" type="checkbox" class="custom-control-input"
                                  id="Excel" />
                                <label class="custom-control-label mb-0" for="Excel">Excel</label>
                              </div>
                            </div>
                            <div class="col-4">
                              <div class="custom-control custom-checkbox">
                                <input formControlName="pdfExport" type="checkbox" class="custom-control-input"
                                  id="PDF" />
                                <label class="custom-control-label mb-0" for="PDF">PDF</label>
                              </div>
                            </div>

                            <div
                              *ngIf="isReportScheduleFormSubmitted && (f_schedule.pdfExport.errors || f_schedule.excelExport.errors || f_schedule.csvExport.errors)"
                              class="invalid-feedback">
                              <div *ngIf="f_schedule.exportFormat.errors.required">
                                Export Format is required
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-md-6">
                        <div class="group-from">
                          <h5 class="title">Last Run</h5>
                          <div class="form-row form-group align-items-center">
                            <div class="col-10">
                              <input onkeydown="return false" type="text" class="form-control" [disabled]="true"
                                formControlName="lastRun" placeholder="Never" readonly />
                              <!-- (bsValueChange)="specDateChange($event, last_run.value)" -->
                            </div>
                            <!-- <div class="col-2"><button class="btn blue browse-btn" disabled>Reset</button></div> -->
                          </div>
                        </div>
                      </div>
                    </div>
                    <!-- 123 -->
                    <div class="form-row form-group align-items-center">
                      <div class="group-from col-md-6">
                        <h5 class="title">
                          Inception
                        </h5>
                        <div class="form-row form-group align-items-center mb-0">
                          <div class="col-12">
                            <div class="row align-items-center">
                              <div class="col-5  mt-27">
                                <div class="form-group mb-0">
                                  <div class="ctm-calendar">
                                    <!-- [maxDate]="maxDate" -->
                                    <input #inceptionDate type="text" class="form-control"
                                      formControlName="inceptionDate" bsDatepicker [minDate]="maxDate"
                                      [bsConfig]="{ showWeekNumbers: false,adaptivePosition: true}"
                                      [ngClass]="{'is-invalid': isReportScheduleFormSubmitted && f_schedule.startDate.errors}"
                                      readonly />
                                    <!-- (bsValueChange)=" specDateChange($event, inceptionDate.value) " -->
                                    <div *ngIf="f_schedule.startDate.errors" class="invalid-feedback">
                                      <div *ngIf="f_schedule.startDate.errors.required">
                                        Inception is required
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="col-7">
                                <div class="form-group mb-0">
                                  <div class="ctm-timepicker">
                                    <timepicker class="form-timepicker" formControlName="inceptionTime" #dateTimeSch>
                                    </timepicker>
                                    <div *ngIf="f_schedule.endDate.errors" class="invalid-feedback">
                                      <div *ngIf="f_schedule.endDate.errors.required">
                                        End date is required
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-md-6 text-right  mt-5">
                        <div class="custom-control custom-checkbox sd-checkbox-active">
                          <input formControlName="isFlags" class="custom-control-input" type="checkbox" id="isFlags"
                            checked>
                          <label for="isFlags" class="custom-control-label mb-0">
                            <h6 class="mb-0">Active</h6>
                          </label>
                        </div>
                        <!-- <button class="btn btn-blue">Flags</button> -->
                      </div>
                    </div>
                  </div>
                </div>
                <div class="tab-pane" id="menu1">1234</div>
              </div>
            </div>
          </div>
          <div class="col-12 p-0">
            <div class="btn-wrap text-right mt-10">
              <button class="btn btn-blue mr-2" (click)="scheduleData()">
                Ok
              </button>
              <a class="btn btn-grey" (click)="resetScheduleform()" data-dismiss="modal">Cancel</a>
            </div>
          </div>
        </div>
      </div>
      <!-- </div> -->
    </div>
    <!-- </div> -->
  </form>
</div>
<div class="modal fade thm-popup" id="warningModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
  aria-hidden="true" data-backdrop="static">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-body popup-box-width">
        <div class="popup-box">
          <form name="searchForm" id="searchForm">
            <div class="title-wrap mb-2">
              <h4 class="title">Warning

              </h4>
            </div>
            <div class="form-group mb-0 d-flex align-items-center">
              <span class="p-4 fontexcla_icon"><i class="fa fa-exclamation-triangle"></i></span><label>
                Date range not valid for {{salesByText}} : <br>
                {{ f?.startDate?.value | date: "d MMM y" }} to {{ f?.endDate?.value | date: "d MMM y" }} ({{totalDays}}
                days).<br>
                {{salesByText}} requires a 7 day date range .<br>
                Continue anyway?
              </label>
            </div>
            <div class="btn-wrap text-right mt-10">
              <button class="btn btn-blue mr-2" (click)="sumbitWarningPopup()">Yes</button>
              <button class="btn btn-grey" (click)="cancelWarningPopup()">No</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>